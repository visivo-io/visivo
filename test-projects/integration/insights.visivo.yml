insights:
  # Simple scatter insight with basic props
  - name: simple-scatter-insight
    description: "Basic scatter plot showing x vs y from join_table"
    props:
      type: scatter
      mode: markers+lines
      x: ?{${ref(another_local_test_table).new_x}}
      y: ?{${ref(another_local_test_table).new_y}}
      marker:
        color: "#713B57"
        size: 10
      line:
        color: "#4F494C"
        width: 2
  - name: composite-scatter-insight
    props: 
      type: scatter 
      x: ?{${ref(another_local_test_table).new_x}}
      y: ?{${ref(composite_metric)}}


  # Bar chart insight with split interaction (replaces cohort_on)
  - name: fibonacci-split-insight
    description: "Bar chart with split based on y value threshold"
    props:
      type: bar
      x: ?{${ref(another_local_test_table).new_x}}
      y: ?{${ref(another_local_test_table).new_y}}
      marker:
        color: ?{ case when ${ref(another_local_test_table).new_x} >= 5 then '#713B57' else '#4F494C' end }
    interactions:
      - split: ?{ CASE WHEN ${ref(another_local_test_table).new_y} >= 6 THEN 'Normal Fibonacci' ELSE 'Abnormal Fib' END }
      - sort: ?{${ref(another_local_test_table).new_x} ASC}

  # Aggregated bar chart with filter
  - name: aggregated-bar-insight
    description: "Aggregated bar chart with conditional grouping"
    props:
      type: bar
      x: ?{ CASE WHEN ${ref(local_test_table).x} <= 3 THEN 'less' else 'More' END }
      y: ?{ avg(${ref(local_test_table).y}) }
      marker:
        color: ["rgb(142,124,195)", "rgba(204,204,204,1)"]
        line:
          color: ?{CASE WHEN ${ref(local_test_table).x} <= 3 THEN '#D25946' else '#191D33' END}
          width: 2.5

  # 3D scatter with filter interaction
  - name: 3d-scatter-insight
    description: "3D scatter plot with calculated z-axis"
    props:
      type: scatter3d
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      z: ?{ -2*(${ref(local_test_table).x}/16)*${ref(local_test_table).x} + ${ref(local_test_table).x} + ${ref(local_test_table).y}*(${ref(local_test_table).y}-3)}
      mode: markers+lines
      marker:
        size: 8
        color: "#713B57"
    interactions:
      - filter: ?{${ref(local_test_table).x} > 1}
      - sort: ?{${ref(local_test_table).x} ASC}

  # Line chart with metric usage
  - name: metric-line-insight
    description: "Line chart using model-defined metrics"
    props:
      type: scatter
      mode: lines
      x: ?{${ref(local_test_table).x_rounded}}
      y: ?{${ref(local_test_table).x_sum}}
      line:
        color: "#D25946"
        shape: spline
