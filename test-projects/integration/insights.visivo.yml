insights:
  # Simple scatter insight with basic props
  - name: simple-scatter-insight
    description: "Basic scatter plot showing x vs y from join_table"
    props:
      type: scatter
      mode: markers+lines
      x: ?{${ref(another_local_test_table).new_x}}
      y: ?{${ref(another_local_test_table).new_y}}
      marker:
        color: "#713B57"
        size: 10
      line:
        color: "#4F494C"
        width: 2
  - name: composite-scatter-insight
    props: 
      type: scatter 
      x: ?{${ref(another_local_test_table).new_x}}
      y: ?{${ref(composite_metric)}}


  # Bar chart insight with split interaction (replaces cohort_on)
  - name: fibonacci-split-insight
    description: "Bar chart with split based on y value threshold"
    props:
      type: bar
      x: ?{${ref(another_local_test_table).new_x}}
      y: ?{${ref(another_local_test_table).new_y}}
      marker:
        color: ?{ case when ${ref(another_local_test_table).new_x} >= 5 then '#713B57' else '#4F494C' end }
    interactions:
      - split: ?{ CASE WHEN ${ref(another_local_test_table).new_y} >= 6 THEN 'Normal Fibonacci' ELSE 'Abnormal Fib' END }
      - sort: ?{${ref(another_local_test_table).new_x} ASC}

  # Aggregated bar chart with filter
  - name: aggregated-bar-insight
    description: "Aggregated bar chart with conditional grouping"
    props:
      type: bar
      x: ?{ CASE WHEN ${ref(local_test_table).x} <= 3 THEN 'less' else 'More' END }
      y: ?{ avg(${ref(local_test_table).y}) }
      marker:
        color: ["rgb(142,124,195)", "rgba(204,204,204,1)"]
        line:
          color: ?{CASE WHEN ${ref(local_test_table).x} <= 3 THEN '#D25946' else '#191D33' END}
          width: 2.5

  # 3D scatter with filter interaction
  - name: 3d-scatter-insight
    description: "3D scatter plot with calculated z-axis"
    props:
      type: scatter3d
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      z: ?{ -2*(${ref(local_test_table).x}/16)*${ref(local_test_table).x} + ${ref(local_test_table).x} + ${ref(local_test_table).y}*(${ref(local_test_table).y}-3)}
      mode: markers+lines
      marker:
        size: 8
        color: "#713B57"
    interactions:
      - filter: ?{${ref(local_test_table).x} > 1}
      - sort: ?{${ref(local_test_table).x} ASC}

  # Line chart with metric usage
  - name: metric-line-insight
    description: "Line chart using model-defined metrics"
    props:
      type: scatter
      mode: lines
      x: ?{${ref(local_test_table).x_rounded}}
      y: ?{${ref(local_test_table).x_sum}}
      line:
        color: "#D25946"
        shape: spline

  # ===== INPUT-DRIVEN INSIGHTS FOR TESTING =====

  # Test Split Interaction with Input
  - name: split-input-test-insight
    description: "Bar chart with dynamic split based on input threshold"
    props:
      type: bar
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      marker:
        color: ?{ CASE WHEN ${ref(local_test_table).x} >= ${ref(split_threshold).value} THEN '#713B57' ELSE '#D25946' END }
    interactions:
      - split: ?{ CASE WHEN ${ref(local_test_table).x} >= ${ref(split_threshold).value} THEN 'High Y Values' ELSE 'Low Y Values' END }
      - sort: ?{${ref(local_test_table).x} desc}

  # Test Non-Aggregate Filter with Input
  - name: filter-nonaggregate-input-test-insight
    description: "Scatter plot with dynamic non-aggregate filter"
    props:
      type: scatter
      mode: markers+lines
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      marker:
        size: 10
        color: "#4F494C"
      line:
        color: "#713B57"
        width: 2
    interactions:
      - filter: ?{${ref(local_test_table).x} > ${ref(min_x_value).value}}
      - sort: ?{${ref(local_test_table).x} ASC}

  # Test Aggregate Filter with Input
  - name: filter-aggregate-input-test-insight
    description: "Aggregated bar chart with dynamic aggregate filter (HAVING)"
    props:
      type: bar
      x: ?{ CASE WHEN ${ref(local_test_table).x} <= 3 THEN 'Group A' ELSE 'Group B' END }
      y: ?{ AVG(${ref(local_test_table).y}) }
      marker:
        color: ["red", "green"]
    interactions:
      - filter: ?{ ${ref(local_test_table).y} > ${ref(min_avg_y).value} }

  # Test Sort Order with Input
  - name: sort-input-test-insight
    description: "Line chart with dynamic sort direction"
    props:
      type: scatter
      mode: lines+markers
      x: ?{${ref(another_local_test_table).new_x}}
      y: ?{${ref(another_local_test_table).new_y}}
      line:
        shape: spline
        color: "#191D33"
      marker:
        size: 8
        color: "#D25946"
    interactions:
      - sort: ?{${ref(another_local_test_table).new_x} ${ref(sort_direction).value}}

  # Combined Test - All Interactions with Inputs
  - name: combined-interactions-test-insight
    description: "Chart testing split, filter, and sort together"
    props:
      type: bar
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      marker:
        color: ?{ CASE WHEN ${ref(local_test_table).x} >= ${ref(split_threshold).value} THEN '#713B57' ELSE '#4F494C' END }
    interactions:
      - split: ?{ CASE WHEN ${ref(local_test_table).x} >= ${ref(split_threshold).value} THEN 'Above Threshold' ELSE 'Below Threshold' END }
      - filter: ?{${ref(local_test_table).x} > ${ref(min_x_value).value}}
      - sort: ?{${ref(local_test_table).x} ${ref(sort_direction).value}}

  # ===== INPUT DISPLAY SHOWCASE INSIGHTS =====

  # Toggle input test - dynamic mode switching
  - name: toggle-mode-insight
    description: "Scatter plot with dynamic mode from toggle input"
    props:
      type: scatter
      mode: ${ref(show_markers).value}
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      line:
        color: "#713B57"
        width: 2
      marker:
        size: 10
        color: "#D25946"
    interactions:
      - sort: ?{${ref(local_test_table).x} ASC}

  # Multi-select range slider test - filter by range
  - name: range-slider-insight
    description: "Bar chart filtered by range slider min/max"
    props:
      type: bar
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      marker:
        color: "#4F494C"
    interactions:
      - filter: ?{${ref(local_test_table).x} >= ${ref(x_value_range).min} AND ${ref(local_test_table).x} <= ${ref(x_value_range).max}}
      - sort: ?{${ref(local_test_table).x} ASC}

  # Multi-select checkboxes test - filter by selected values
  - name: checkboxes-filter-insight
    description: "Scatter plot filtered by checkbox selections"
    props:
      type: scatter
      mode: markers
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      marker:
        size: 12
        color: "#191D33"
    interactions:
      - filter: ?{CAST(${ref(local_test_table).x} AS VARCHAR) IN (${ref(selected_x_values).values})}
      #- sort: ?{${ref(local_test_table).x} ASC}

  # Multi-select chips test - dynamic split based on first/last accessors
  - name: chips-split-insight
    description: "Bar chart with split using chips input first/last values"
    props:
      type: bar
      x: ?{${ref(local_test_table).x}}
      y: ?{${ref(local_test_table).y}}
      marker:
        color: ?{ CASE WHEN ${ref(local_test_table).x} <= 5 THEN '#713B57' ELSE '#D25946' END }
    interactions:
      - split: ?{ CASE WHEN ${ref(local_test_table).y} >= 5 THEN '${ref(selected_tags).first}' ELSE '${ref(selected_tags).last}' END }
      - sort: ?{${ref(local_test_table).x} ASC}

  # ===== DATE-BASED INSIGHTS (testing new date inputs) =====

  # Autocomplete single-select test - filter to selected date
  - name: autocomplete-date-insight
    description: "Line chart filtered to a single date selected via autocomplete"
    props:
      type: scatter
      mode: lines+markers
      x: ?{${ref(daily_metrics).formatted_date}}
      y: ?{${ref(daily_metrics).value}}
      marker:
        size: 10
        color: "#713B57"
      line:
        color: "#4F494C"
        width: 2
    interactions:
      - filter: ?{${ref(daily_metrics).formatted_date} <= '${ref(autocomplete_date).value}'}
      - sort: ?{${ref(daily_metrics).day_num} ASC}

  # Slider single-select test - filter by day number
  - name: slider-day-insight
    description: "Bar chart filtered by slider-selected day number"
    props:
      type: bar
      x: ?{${ref(daily_metrics).day_num}}
      y: ?{${ref(daily_metrics).value}}
      marker:
        color: ?{ CASE WHEN ${ref(daily_metrics).day_num} <= ${ref(slider_day_num).value} THEN '#713B57' ELSE '#D25946' END }
    interactions:
      - filter: ?{${ref(daily_metrics).day_num} <= ${ref(slider_day_num).value}}
      - sort: ?{${ref(daily_metrics).day_num} ASC}

  # Date range multi-select test - filter by date range
  - name: date-range-filter-insight
    description: "Line chart filtered by date range picker"
    props:
      type: scatter
      mode: lines+markers
      x: ?{${ref(daily_metrics).formatted_date}}
      y: ?{${ref(daily_metrics).value}}
      marker:
        size: 8
        color: "#191D33"
      line:
        color: "#713B57"
        shape: spline
    interactions:
      - filter: ?{${ref(daily_metrics).formatted_date} >= '${ref(static_date_range).first}' AND ${ref(daily_metrics).formatted_date} <= '${ref(static_date_range).last}'}
      - sort: ?{${ref(daily_metrics).formatted_date} ASC}

  # Date range with aggregation - bar chart by category
  - name: date-range-category-insight
    description: "Aggregated bar chart by category within date range"
    props:
      type: bar
      x: ?{${ref(daily_metrics).category}}
      y: ?{${ref(daily_metrics).total_value}}
      marker:
        color: ["#713B57", "#4F494C", "#D25946"]
    interactions:
      - filter: ?{${ref(daily_metrics).date} between '${ref(static_date_range).min}'::date AND '${ref(static_date_range).max}'::date}
      - filter: ?{${ref(daily_metrics).category} in ( ${ref(selected_categories).values} ) }

  # Week selector test - filter by week start
  - name: week-selector-insight
    description: "Scatter plot showing data from selected week onwards"
    props:
      type: scatter
      mode: markers
      x: ?{${ref(daily_metrics).day_num}}
      y: ?{${ref(daily_metrics).value}}
      marker:
        size: 12
        color: "#D25946"
        symbol: "diamond"
    interactions:
      - filter: ?{${ref(daily_metrics).formatted_date} >= '${ref(week_selector).value}'}
      - sort: ?{${ref(daily_metrics).day_num} ASC}
